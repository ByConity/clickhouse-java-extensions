package org.byconity.iceberg.cli;

import com.google.common.collect.Lists;
import org.apache.iceberg.FileFormat;
import org.junit.Assert;
import org.junit.Test;

import java.util.List;

public class IcebergCliTpcdsTest extends IcebergCliTestBase {

    @Test
    public void testNonPrimaryTpcdsWithFormatOrc() throws Exception {
        testNonPrimaryTpcdsWithFormat(FileFormat.ORC);
        Assert.assertEquals(testOut.getContent(),
                "Create database 'test_tpcds_non_primary' successfully.\n"
                        + "Create table 'test_tpcds_non_primary.call_center' successfully.\n"
                        + "Table 'test_tpcds_non_primary.call_center' schema:\n" + "\tFields:\n"
                        + "\t\t1: cc_call_center_sk: optional long\n"
                        + "\t\t2: cc_call_center_id: optional string\n"
                        + "\t\t3: cc_rec_start_date: optional date\n"
                        + "\t\t4: cc_rec_end_date: optional date\n"
                        + "\t\t5: cc_closed_date_sk: optional int\n"
                        + "\t\t6: cc_open_date_sk: optional int\n"
                        + "\t\t7: cc_name: optional string\n" + "\t\t8: cc_class: optional string\n"
                        + "\t\t9: cc_employees: optional int\n" + "\t\t10: cc_sq_ft: optional int\n"
                        + "\t\t11: cc_hours: optional string\n"
                        + "\t\t12: cc_manager: optional string\n"
                        + "\t\t13: cc_mkt_id: optional int\n"
                        + "\t\t14: cc_mkt_class: optional string\n"
                        + "\t\t15: cc_mkt_desc: optional string\n"
                        + "\t\t16: cc_market_manager: optional string\n"
                        + "\t\t17: cc_division: optional int\n"
                        + "\t\t18: cc_division_name: optional string\n"
                        + "\t\t19: cc_company: optional int\n"
                        + "\t\t20: cc_company_name: optional string\n"
                        + "\t\t21: cc_street_number: optional string\n"
                        + "\t\t22: cc_street_name: optional string\n"
                        + "\t\t23: cc_street_type: optional string\n"
                        + "\t\t24: cc_suite_number: optional string\n"
                        + "\t\t25: cc_city: optional string\n"
                        + "\t\t26: cc_county: optional string\n"
                        + "\t\t27: cc_state: optional string\n"
                        + "\t\t28: cc_zip: optional string\n"
                        + "\t\t29: cc_country: optional string\n"
                        + "\t\t30: cc_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t31: cc_tax_percentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.call_center' successfully, 6 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_page' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_page' schema:\n" + "\tFields:\n"
                        + "\t\t1: cp_catalog_page_sk: optional long\n"
                        + "\t\t2: cp_catalog_page_id: optional string\n"
                        + "\t\t3: cp_start_date_sk: optional int\n"
                        + "\t\t4: cp_end_date_sk: optional int\n"
                        + "\t\t5: cp_department: optional string\n"
                        + "\t\t6: cp_catalog_number: optional int\n"
                        + "\t\t7: cp_catalog_page_number: optional int\n"
                        + "\t\t8: cp_description: optional string\n"
                        + "\t\t9: cp_type: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_page' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: cr_returned_date_sk: optional long\n"
                        + "\t\t2: cr_returned_time_sk: optional long\n"
                        + "\t\t3: cr_item_sk: optional long\n"
                        + "\t\t4: cr_refunded_customer_sk: optional long\n"
                        + "\t\t5: cr_refunded_cdemo_sk: optional long\n"
                        + "\t\t6: cr_refunded_hdemo_sk: optional long\n"
                        + "\t\t7: cr_refunded_addr_sk: optional long\n"
                        + "\t\t8: cr_returning_customer_sk: optional long\n"
                        + "\t\t9: cr_returning_cdemo_sk: optional long\n"
                        + "\t\t10: cr_returning_hdemo_sk: optional long\n"
                        + "\t\t11: cr_returning_addr_sk: optional long\n"
                        + "\t\t12: cr_call_center_sk: optional long\n"
                        + "\t\t13: cr_catalog_page_sk: optional long\n"
                        + "\t\t14: cr_ship_mode_sk: optional long\n"
                        + "\t\t15: cr_warehouse_sk: optional long\n"
                        + "\t\t16: cr_reason_sk: optional long\n"
                        + "\t\t17: cr_order_number: optional long\n"
                        + "\t\t18: cr_return_quantity: optional int\n"
                        + "\t\t19: cr_return_amount: optional decimal(7, 2)\n"
                        + "\t\t20: cr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t21: cr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t22: cr_fee: optional decimal(7, 2)\n"
                        + "\t\t23: cr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t24: cr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t25: cr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t26: cr_store_credit: optional decimal(7, 2)\n"
                        + "\t\t27: cr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: cs_sold_date_sk: optional long\n"
                        + "\t\t2: cs_sold_time_sk: optional long\n"
                        + "\t\t3: cs_ship_date_sk: optional long\n"
                        + "\t\t4: cs_bill_customer_sk: optional long\n"
                        + "\t\t5: cs_bill_cdemo_sk: optional long\n"
                        + "\t\t6: cs_bill_hdemo_sk: optional long\n"
                        + "\t\t7: cs_bill_addr_sk: optional long\n"
                        + "\t\t8: cs_ship_customer_sk: optional long\n"
                        + "\t\t9: cs_ship_cdemo_sk: optional long\n"
                        + "\t\t10: cs_ship_hdemo_sk: optional long\n"
                        + "\t\t11: cs_ship_addr_sk: optional long\n"
                        + "\t\t12: cs_call_center_sk: optional long\n"
                        + "\t\t13: cs_catalog_page_sk: optional long\n"
                        + "\t\t14: cs_ship_mode_sk: optional long\n"
                        + "\t\t15: cs_warehouse_sk: optional long\n"
                        + "\t\t16: cs_item_sk: optional long\n"
                        + "\t\t17: cs_promo_sk: optional long\n"
                        + "\t\t18: cs_order_number: optional long\n"
                        + "\t\t19: cs_quantity: optional int\n"
                        + "\t\t20: cs_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t21: cs_list_price: optional decimal(7, 2)\n"
                        + "\t\t22: cs_sales_price: optional decimal(7, 2)\n"
                        + "\t\t23: cs_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t24: cs_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t25: cs_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t26: cs_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t27: cs_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t28: cs_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t29: cs_ext_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t30: cs_net_paid: optional decimal(7, 2)\n"
                        + "\t\t31: cs_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t32: cs_net_paid_inc_ship: optional decimal(7, 2)\n"
                        + "\t\t33: cs_net_paid_inc_ship_tax: optional decimal(7, 2)\n"
                        + "\t\t34: cs_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer' schema:\n" + "\tFields:\n"
                        + "\t\t1: c_customer_sk: optional long\n"
                        + "\t\t2: c_customer_id: optional string\n"
                        + "\t\t3: c_current_cdemo_sk: optional long\n"
                        + "\t\t4: c_current_hdemo_sk: optional long\n"
                        + "\t\t5: c_current_addr_sk: optional long\n"
                        + "\t\t6: c_first_shipto_date_sk: optional long\n"
                        + "\t\t7: c_first_sales_date_sk: optional long\n"
                        + "\t\t8: c_salutation: optional string\n"
                        + "\t\t9: c_first_name: optional string\n"
                        + "\t\t10: c_last_name: optional string\n"
                        + "\t\t11: c_preferred_cust_flag: optional string\n"
                        + "\t\t12: c_birth_day: optional int\n"
                        + "\t\t13: c_birth_month: optional int\n"
                        + "\t\t14: c_birth_year: optional int\n"
                        + "\t\t15: c_birth_country: optional string\n"
                        + "\t\t16: c_login: optional string\n"
                        + "\t\t17: c_email_address: optional string\n"
                        + "\t\t18: c_last_review_date: optional long\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer_address' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer_address' schema:\n"
                        + "\tFields:\n" + "\t\t1: ca_address_sk: optional long\n"
                        + "\t\t2: ca_address_id: optional string\n"
                        + "\t\t3: ca_street_number: optional string\n"
                        + "\t\t4: ca_street_name: optional string\n"
                        + "\t\t5: ca_street_type: optional string\n"
                        + "\t\t6: ca_suite_number: optional string\n"
                        + "\t\t7: ca_city: optional string\n"
                        + "\t\t8: ca_county: optional string\n"
                        + "\t\t9: ca_state: optional string\n" + "\t\t10: ca_zip: optional string\n"
                        + "\t\t11: ca_country: optional string\n"
                        + "\t\t12: ca_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t13: ca_location_type: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer_address' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer_demographics' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer_demographics' schema:\n"
                        + "\tFields:\n" + "\t\t1: cd_demo_sk: optional long\n"
                        + "\t\t2: cd_gender: optional string\n"
                        + "\t\t3: cd_marital_status: optional string\n"
                        + "\t\t4: cd_education_status: optional string\n"
                        + "\t\t5: cd_purchase_estimate: optional int\n"
                        + "\t\t6: cd_credit_rating: optional string\n"
                        + "\t\t7: cd_dep_count: optional int\n"
                        + "\t\t8: cd_dep_employed_count: optional int\n"
                        + "\t\t9: cd_dep_college_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer_demographics' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.date_dim' successfully.\n"
                        + "Table 'test_tpcds_non_primary.date_dim' schema:\n" + "\tFields:\n"
                        + "\t\t1: d_date_sk: optional long\n"
                        + "\t\t2: d_date_id: optional string\n" + "\t\t3: d_date: optional date\n"
                        + "\t\t4: d_month_seq: optional int\n" + "\t\t5: d_week_seq: optional int\n"
                        + "\t\t6: d_quarter_seq: optional int\n" + "\t\t7: d_year: optional int\n"
                        + "\t\t8: d_dow: optional int\n" + "\t\t9: d_moy: optional int\n"
                        + "\t\t10: d_dom: optional int\n" + "\t\t11: d_qoy: optional int\n"
                        + "\t\t12: d_fy_year: optional int\n"
                        + "\t\t13: d_fy_quarter_seq: optional int\n"
                        + "\t\t14: d_fy_week_seq: optional int\n"
                        + "\t\t15: d_day_name: optional string\n"
                        + "\t\t16: d_quarter_name: optional string\n"
                        + "\t\t17: d_holiday: optional string\n"
                        + "\t\t18: d_weekend: optional string\n"
                        + "\t\t19: d_following_holiday: optional string\n"
                        + "\t\t20: d_first_dom: optional int\n"
                        + "\t\t21: d_last_dom: optional int\n"
                        + "\t\t22: d_same_day_ly: optional int\n"
                        + "\t\t23: d_same_day_lq: optional int\n"
                        + "\t\t24: d_current_day: optional string\n"
                        + "\t\t25: d_current_week: optional string\n"
                        + "\t\t26: d_current_month: optional string\n"
                        + "\t\t27: d_current_quarter: optional string\n"
                        + "\t\t28: d_current_year: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.date_dim' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.household_demographics' successfully.\n"
                        + "Table 'test_tpcds_non_primary.household_demographics' schema:\n"
                        + "\tFields:\n" + "\t\t1: hd_demo_sk: optional long\n"
                        + "\t\t2: hd_income_band_sk: optional long\n"
                        + "\t\t3: hd_buy_potential: optional string\n"
                        + "\t\t4: hd_dep_count: optional int\n"
                        + "\t\t5: hd_vehicle_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.household_demographics' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.income_band' successfully.\n"
                        + "Table 'test_tpcds_non_primary.income_band' schema:\n" + "\tFields:\n"
                        + "\t\t1: ib_income_band_sk: optional long\n"
                        + "\t\t2: ib_lower_bound: optional int\n"
                        + "\t\t3: ib_upper_bound: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.income_band' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.inventory' successfully.\n"
                        + "Table 'test_tpcds_non_primary.inventory' schema:\n" + "\tFields:\n"
                        + "\t\t1: inv_date_sk: optional long\n"
                        + "\t\t2: inv_item_sk: optional long\n"
                        + "\t\t3: inv_warehouse_sk: optional long\n"
                        + "\t\t4: inv_quantity_on_hand: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.inventory' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.item' successfully.\n"
                        + "Table 'test_tpcds_non_primary.item' schema:\n" + "\tFields:\n"
                        + "\t\t1: i_item_sk: optional long\n"
                        + "\t\t2: i_item_id: optional string\n"
                        + "\t\t3: i_rec_start_date: optional date\n"
                        + "\t\t4: i_rec_end_date: optional date\n"
                        + "\t\t5: i_item_desc: optional string\n"
                        + "\t\t6: i_current_price: optional decimal(7, 2)\n"
                        + "\t\t7: i_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t8: i_brand_id: optional int\n" + "\t\t9: i_brand: optional string\n"
                        + "\t\t10: i_class_id: optional int\n"
                        + "\t\t11: i_class: optional string\n"
                        + "\t\t12: i_category_id: optional int\n"
                        + "\t\t13: i_category: optional string\n"
                        + "\t\t14: i_manufact_id: optional int\n"
                        + "\t\t15: i_manufact: optional string\n"
                        + "\t\t16: i_size: optional string\n"
                        + "\t\t17: i_formulation: optional string\n"
                        + "\t\t18: i_color: optional string\n"
                        + "\t\t19: i_units: optional string\n"
                        + "\t\t20: i_container: optional string\n"
                        + "\t\t21: i_manager_id: optional int\n"
                        + "\t\t22: i_product_name: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.item' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.promotion' successfully.\n"
                        + "Table 'test_tpcds_non_primary.promotion' schema:\n" + "\tFields:\n"
                        + "\t\t1: p_promo_sk: optional long\n"
                        + "\t\t2: p_promo_id: optional string\n"
                        + "\t\t3: p_start_date_sk: optional long\n"
                        + "\t\t4: p_end_date_sk: optional long\n"
                        + "\t\t5: p_item_sk: optional long\n"
                        + "\t\t6: p_cost: optional decimal(15, 2)\n"
                        + "\t\t7: p_response_target: optional int\n"
                        + "\t\t8: p_promo_name: optional string\n"
                        + "\t\t9: p_channel_dmail: optional string\n"
                        + "\t\t10: p_channel_email: optional string\n"
                        + "\t\t11: p_channel_catalog: optional string\n"
                        + "\t\t12: p_channel_tv: optional string\n"
                        + "\t\t13: p_channel_radio: optional string\n"
                        + "\t\t14: p_channel_press: optional string\n"
                        + "\t\t15: p_channel_event: optional string\n"
                        + "\t\t16: p_channel_demo: optional string\n"
                        + "\t\t17: p_channel_details: optional string\n"
                        + "\t\t18: p_purpose: optional string\n"
                        + "\t\t19: p_discount_active: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.promotion' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.reason' successfully.\n"
                        + "Table 'test_tpcds_non_primary.reason' schema:\n" + "\tFields:\n"
                        + "\t\t1: r_reason_sk: optional long\n"
                        + "\t\t2: r_reason_id: optional string\n"
                        + "\t\t3: r_reason_desc: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.reason' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.ship_mode' successfully.\n"
                        + "Table 'test_tpcds_non_primary.ship_mode' schema:\n" + "\tFields:\n"
                        + "\t\t1: sm_ship_mode_sk: optional long\n"
                        + "\t\t2: sm_ship_mode_id: optional string\n"
                        + "\t\t3: sm_type: optional string\n" + "\t\t4: sm_code: optional string\n"
                        + "\t\t5: sm_carrier: optional string\n"
                        + "\t\t6: sm_contract: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.ship_mode' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store' schema:\n" + "\tFields:\n"
                        + "\t\t1: s_store_sk: optional long\n"
                        + "\t\t2: s_store_id: optional string\n"
                        + "\t\t3: s_rec_start_date: optional date\n"
                        + "\t\t4: s_rec_end_date: optional date\n"
                        + "\t\t5: s_closed_date_sk: optional long\n"
                        + "\t\t6: s_store_name: optional string\n"
                        + "\t\t7: s_number_employees: optional int\n"
                        + "\t\t8: s_floor_space: optional int\n"
                        + "\t\t9: s_hours: optional string\n"
                        + "\t\t10: s_manager: optional string\n"
                        + "\t\t11: s_market_id: optional int\n"
                        + "\t\t12: s_geography_class: optional string\n"
                        + "\t\t13: s_market_desc: optional string\n"
                        + "\t\t14: s_market_manager: optional string\n"
                        + "\t\t15: s_division_id: optional int\n"
                        + "\t\t16: s_division_name: optional string\n"
                        + "\t\t17: s_company_id: optional int\n"
                        + "\t\t18: s_company_name: optional string\n"
                        + "\t\t19: s_street_number: optional string\n"
                        + "\t\t20: s_street_name: optional string\n"
                        + "\t\t21: s_street_type: optional string\n"
                        + "\t\t22: s_suite_number: optional string\n"
                        + "\t\t23: s_city: optional string\n"
                        + "\t\t24: s_county: optional string\n"
                        + "\t\t25: s_state: optional string\n" + "\t\t26: s_zip: optional string\n"
                        + "\t\t27: s_country: optional string\n"
                        + "\t\t28: s_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t29: s_tax_precentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store' successfully, 12 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: sr_returned_date_sk: optional long\n"
                        + "\t\t2: sr_return_time_sk: optional long\n"
                        + "\t\t3: sr_item_sk: optional long\n"
                        + "\t\t4: sr_customer_sk: optional long\n"
                        + "\t\t5: sr_cdemo_sk: optional long\n"
                        + "\t\t6: sr_hdemo_sk: optional long\n"
                        + "\t\t7: sr_addr_sk: optional long\n"
                        + "\t\t8: sr_store_sk: optional long\n"
                        + "\t\t9: sr_reason_sk: optional long\n"
                        + "\t\t10: sr_ticket_number: optional long\n"
                        + "\t\t11: sr_return_quantity: optional int\n"
                        + "\t\t12: sr_return_amt: optional decimal(7, 2)\n"
                        + "\t\t13: sr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t14: sr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t15: sr_fee: optional decimal(7, 2)\n"
                        + "\t\t16: sr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t17: sr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t18: sr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t19: sr_store_credit: optional decimal(7, 2)\n"
                        + "\t\t20: sr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: ss_sold_date_sk: optional long\n"
                        + "\t\t2: ss_sold_time_sk: optional long\n"
                        + "\t\t3: ss_item_sk: optional long\n"
                        + "\t\t4: ss_customer_sk: optional long\n"
                        + "\t\t5: ss_cdemo_sk: optional long\n"
                        + "\t\t6: ss_hdemo_sk: optional long\n"
                        + "\t\t7: ss_addr_sk: optional long\n"
                        + "\t\t8: ss_store_sk: optional long\n"
                        + "\t\t9: ss_promo_sk: optional long\n"
                        + "\t\t10: ss_ticket_number: optional long\n"
                        + "\t\t11: ss_quantity: optional int\n"
                        + "\t\t12: ss_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t13: ss_list_price: optional decimal(7, 2)\n"
                        + "\t\t14: ss_sales_price: optional decimal(7, 2)\n"
                        + "\t\t15: ss_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t16: ss_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t17: ss_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t18: ss_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t19: ss_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t20: ss_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t21: ss_net_paid: optional decimal(7, 2)\n"
                        + "\t\t22: ss_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t23: ss_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.time_dim' successfully.\n"
                        + "Table 'test_tpcds_non_primary.time_dim' schema:\n" + "\tFields:\n"
                        + "\t\t1: t_time_sk: optional long\n"
                        + "\t\t2: t_time_id: optional string\n" + "\t\t3: t_time: optional int\n"
                        + "\t\t4: t_hour: optional int\n" + "\t\t5: t_minute: optional int\n"
                        + "\t\t6: t_second: optional int\n" + "\t\t7: t_am_pm: optional string\n"
                        + "\t\t8: t_shift: optional string\n"
                        + "\t\t9: t_sub_shift: optional string\n"
                        + "\t\t10: t_meal_time: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.time_dim' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.warehouse' successfully.\n"
                        + "Table 'test_tpcds_non_primary.warehouse' schema:\n" + "\tFields:\n"
                        + "\t\t1: w_warehouse_sk: optional long\n"
                        + "\t\t2: w_warehouse_id: optional string\n"
                        + "\t\t3: w_warehouse_name: optional string\n"
                        + "\t\t4: w_warehouse_sq_ft: optional int\n"
                        + "\t\t5: w_street_number: optional string\n"
                        + "\t\t6: w_street_name: optional string\n"
                        + "\t\t7: w_street_type: optional string\n"
                        + "\t\t8: w_suite_number: optional string\n"
                        + "\t\t9: w_city: optional string\n" + "\t\t10: w_county: optional string\n"
                        + "\t\t11: w_state: optional string\n" + "\t\t12: w_zip: optional string\n"
                        + "\t\t13: w_country: optional string\n"
                        + "\t\t14: w_gmt_offset: optional decimal(5, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.warehouse' successfully, 5 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_page' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_page' schema:\n" + "\tFields:\n"
                        + "\t\t1: wp_web_page_sk: optional long\n"
                        + "\t\t2: wp_web_page_id: optional string\n"
                        + "\t\t3: wp_rec_start_date: optional date\n"
                        + "\t\t4: wp_rec_end_date: optional date\n"
                        + "\t\t5: wp_creation_date_sk: optional long\n"
                        + "\t\t6: wp_access_date_sk: optional long\n"
                        + "\t\t7: wp_autogen_flag: optional string\n"
                        + "\t\t8: wp_customer_sk: optional long\n"
                        + "\t\t9: wp_url: optional string\n" + "\t\t10: wp_type: optional string\n"
                        + "\t\t11: wp_char_count: optional int\n"
                        + "\t\t12: wp_link_count: optional int\n"
                        + "\t\t13: wp_image_count: optional int\n"
                        + "\t\t14: wp_max_ad_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_page' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: wr_returned_date_sk: optional long\n"
                        + "\t\t2: wr_returned_time_sk: optional long\n"
                        + "\t\t3: wr_item_sk: optional long\n"
                        + "\t\t4: wr_refunded_customer_sk: optional long\n"
                        + "\t\t5: wr_refunded_cdemo_sk: optional long\n"
                        + "\t\t6: wr_refunded_hdemo_sk: optional long\n"
                        + "\t\t7: wr_refunded_addr_sk: optional long\n"
                        + "\t\t8: wr_returning_customer_sk: optional long\n"
                        + "\t\t9: wr_returning_cdemo_sk: optional long\n"
                        + "\t\t10: wr_returning_hdemo_sk: optional long\n"
                        + "\t\t11: wr_returning_addr_sk: optional long\n"
                        + "\t\t12: wr_web_page_sk: optional long\n"
                        + "\t\t13: wr_reason_sk: optional long\n"
                        + "\t\t14: wr_order_number: optional long\n"
                        + "\t\t15: wr_return_quantity: optional int\n"
                        + "\t\t16: wr_return_amt: optional decimal(7, 2)\n"
                        + "\t\t17: wr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t18: wr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t19: wr_fee: optional decimal(7, 2)\n"
                        + "\t\t20: wr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t21: wr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t22: wr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t23: wr_account_credit: optional decimal(7, 2)\n"
                        + "\t\t24: wr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: ws_sold_date_sk: optional long\n"
                        + "\t\t2: ws_sold_time_sk: optional long\n"
                        + "\t\t3: ws_ship_date_sk: optional long\n"
                        + "\t\t4: ws_item_sk: optional long\n"
                        + "\t\t5: ws_bill_customer_sk: optional long\n"
                        + "\t\t6: ws_bill_cdemo_sk: optional long\n"
                        + "\t\t7: ws_bill_hdemo_sk: optional long\n"
                        + "\t\t8: ws_bill_addr_sk: optional long\n"
                        + "\t\t9: ws_ship_customer_sk: optional long\n"
                        + "\t\t10: ws_ship_cdemo_sk: optional long\n"
                        + "\t\t11: ws_ship_hdemo_sk: optional long\n"
                        + "\t\t12: ws_ship_addr_sk: optional long\n"
                        + "\t\t13: ws_web_page_sk: optional long\n"
                        + "\t\t14: ws_web_site_sk: optional long\n"
                        + "\t\t15: ws_ship_mode_sk: optional long\n"
                        + "\t\t16: ws_warehouse_sk: optional long\n"
                        + "\t\t17: ws_promo_sk: optional long\n"
                        + "\t\t18: ws_order_number: optional long\n"
                        + "\t\t19: ws_quantity: optional int\n"
                        + "\t\t20: ws_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t21: ws_list_price: optional decimal(7, 2)\n"
                        + "\t\t22: ws_sales_price: optional decimal(7, 2)\n"
                        + "\t\t23: ws_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t24: ws_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t25: ws_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t26: ws_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t27: ws_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t28: ws_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t29: ws_ext_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t30: ws_net_paid: optional decimal(7, 2)\n"
                        + "\t\t31: ws_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t32: ws_net_paid_inc_ship: optional decimal(7, 2)\n"
                        + "\t\t33: ws_net_paid_inc_ship_tax: optional decimal(7, 2)\n"
                        + "\t\t34: ws_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_site' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_site' schema:\n" + "\tFields:\n"
                        + "\t\t1: web_site_sk: optional long\n"
                        + "\t\t2: web_site_id: optional string\n"
                        + "\t\t3: web_rec_start_date: optional date\n"
                        + "\t\t4: web_rec_end_date: optional date\n"
                        + "\t\t5: web_name: optional string\n"
                        + "\t\t6: web_open_date_sk: optional long\n"
                        + "\t\t7: web_close_date_sk: optional long\n"
                        + "\t\t8: web_class: optional string\n"
                        + "\t\t9: web_manager: optional string\n"
                        + "\t\t10: web_mkt_id: optional int\n"
                        + "\t\t11: web_mkt_class: optional string\n"
                        + "\t\t12: web_mkt_desc: optional string\n"
                        + "\t\t13: web_market_manager: optional string\n"
                        + "\t\t14: web_company_id: optional int\n"
                        + "\t\t15: web_company_name: optional string\n"
                        + "\t\t16: web_street_number: optional string\n"
                        + "\t\t17: web_street_name: optional string\n"
                        + "\t\t18: web_street_type: optional string\n"
                        + "\t\t19: web_suite_number: optional string\n"
                        + "\t\t20: web_city: optional string\n"
                        + "\t\t21: web_county: optional string\n"
                        + "\t\t22: web_state: optional string\n"
                        + "\t\t23: web_zip: optional string\n"
                        + "\t\t24: web_country: optional string\n"
                        + "\t\t25: web_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t26: web_tax_percentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:ORC\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_site' successfully, 16 rows have been inserted.\n",
                testOut.getContent());
    }

    @Test
    public void testNonPrimaryTpcdsWithFormatParquet() throws Exception {
        testNonPrimaryTpcdsWithFormat(FileFormat.PARQUET);
        Assert.assertEquals(testOut.getContent(),
                "Create database 'test_tpcds_non_primary' successfully.\n"
                        + "Create table 'test_tpcds_non_primary.call_center' successfully.\n"
                        + "Table 'test_tpcds_non_primary.call_center' schema:\n" + "\tFields:\n"
                        + "\t\t1: cc_call_center_sk: optional long\n"
                        + "\t\t2: cc_call_center_id: optional string\n"
                        + "\t\t3: cc_rec_start_date: optional date\n"
                        + "\t\t4: cc_rec_end_date: optional date\n"
                        + "\t\t5: cc_closed_date_sk: optional int\n"
                        + "\t\t6: cc_open_date_sk: optional int\n"
                        + "\t\t7: cc_name: optional string\n" + "\t\t8: cc_class: optional string\n"
                        + "\t\t9: cc_employees: optional int\n" + "\t\t10: cc_sq_ft: optional int\n"
                        + "\t\t11: cc_hours: optional string\n"
                        + "\t\t12: cc_manager: optional string\n"
                        + "\t\t13: cc_mkt_id: optional int\n"
                        + "\t\t14: cc_mkt_class: optional string\n"
                        + "\t\t15: cc_mkt_desc: optional string\n"
                        + "\t\t16: cc_market_manager: optional string\n"
                        + "\t\t17: cc_division: optional int\n"
                        + "\t\t18: cc_division_name: optional string\n"
                        + "\t\t19: cc_company: optional int\n"
                        + "\t\t20: cc_company_name: optional string\n"
                        + "\t\t21: cc_street_number: optional string\n"
                        + "\t\t22: cc_street_name: optional string\n"
                        + "\t\t23: cc_street_type: optional string\n"
                        + "\t\t24: cc_suite_number: optional string\n"
                        + "\t\t25: cc_city: optional string\n"
                        + "\t\t26: cc_county: optional string\n"
                        + "\t\t27: cc_state: optional string\n"
                        + "\t\t28: cc_zip: optional string\n"
                        + "\t\t29: cc_country: optional string\n"
                        + "\t\t30: cc_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t31: cc_tax_percentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.call_center' successfully, 6 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_page' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_page' schema:\n" + "\tFields:\n"
                        + "\t\t1: cp_catalog_page_sk: optional long\n"
                        + "\t\t2: cp_catalog_page_id: optional string\n"
                        + "\t\t3: cp_start_date_sk: optional int\n"
                        + "\t\t4: cp_end_date_sk: optional int\n"
                        + "\t\t5: cp_department: optional string\n"
                        + "\t\t6: cp_catalog_number: optional int\n"
                        + "\t\t7: cp_catalog_page_number: optional int\n"
                        + "\t\t8: cp_description: optional string\n"
                        + "\t\t9: cp_type: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_page' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: cr_returned_date_sk: optional long\n"
                        + "\t\t2: cr_returned_time_sk: optional long\n"
                        + "\t\t3: cr_item_sk: optional long\n"
                        + "\t\t4: cr_refunded_customer_sk: optional long\n"
                        + "\t\t5: cr_refunded_cdemo_sk: optional long\n"
                        + "\t\t6: cr_refunded_hdemo_sk: optional long\n"
                        + "\t\t7: cr_refunded_addr_sk: optional long\n"
                        + "\t\t8: cr_returning_customer_sk: optional long\n"
                        + "\t\t9: cr_returning_cdemo_sk: optional long\n"
                        + "\t\t10: cr_returning_hdemo_sk: optional long\n"
                        + "\t\t11: cr_returning_addr_sk: optional long\n"
                        + "\t\t12: cr_call_center_sk: optional long\n"
                        + "\t\t13: cr_catalog_page_sk: optional long\n"
                        + "\t\t14: cr_ship_mode_sk: optional long\n"
                        + "\t\t15: cr_warehouse_sk: optional long\n"
                        + "\t\t16: cr_reason_sk: optional long\n"
                        + "\t\t17: cr_order_number: optional long\n"
                        + "\t\t18: cr_return_quantity: optional int\n"
                        + "\t\t19: cr_return_amount: optional decimal(7, 2)\n"
                        + "\t\t20: cr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t21: cr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t22: cr_fee: optional decimal(7, 2)\n"
                        + "\t\t23: cr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t24: cr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t25: cr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t26: cr_store_credit: optional decimal(7, 2)\n"
                        + "\t\t27: cr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: cs_sold_date_sk: optional long\n"
                        + "\t\t2: cs_sold_time_sk: optional long\n"
                        + "\t\t3: cs_ship_date_sk: optional long\n"
                        + "\t\t4: cs_bill_customer_sk: optional long\n"
                        + "\t\t5: cs_bill_cdemo_sk: optional long\n"
                        + "\t\t6: cs_bill_hdemo_sk: optional long\n"
                        + "\t\t7: cs_bill_addr_sk: optional long\n"
                        + "\t\t8: cs_ship_customer_sk: optional long\n"
                        + "\t\t9: cs_ship_cdemo_sk: optional long\n"
                        + "\t\t10: cs_ship_hdemo_sk: optional long\n"
                        + "\t\t11: cs_ship_addr_sk: optional long\n"
                        + "\t\t12: cs_call_center_sk: optional long\n"
                        + "\t\t13: cs_catalog_page_sk: optional long\n"
                        + "\t\t14: cs_ship_mode_sk: optional long\n"
                        + "\t\t15: cs_warehouse_sk: optional long\n"
                        + "\t\t16: cs_item_sk: optional long\n"
                        + "\t\t17: cs_promo_sk: optional long\n"
                        + "\t\t18: cs_order_number: optional long\n"
                        + "\t\t19: cs_quantity: optional int\n"
                        + "\t\t20: cs_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t21: cs_list_price: optional decimal(7, 2)\n"
                        + "\t\t22: cs_sales_price: optional decimal(7, 2)\n"
                        + "\t\t23: cs_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t24: cs_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t25: cs_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t26: cs_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t27: cs_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t28: cs_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t29: cs_ext_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t30: cs_net_paid: optional decimal(7, 2)\n"
                        + "\t\t31: cs_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t32: cs_net_paid_inc_ship: optional decimal(7, 2)\n"
                        + "\t\t33: cs_net_paid_inc_ship_tax: optional decimal(7, 2)\n"
                        + "\t\t34: cs_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer' schema:\n" + "\tFields:\n"
                        + "\t\t1: c_customer_sk: optional long\n"
                        + "\t\t2: c_customer_id: optional string\n"
                        + "\t\t3: c_current_cdemo_sk: optional long\n"
                        + "\t\t4: c_current_hdemo_sk: optional long\n"
                        + "\t\t5: c_current_addr_sk: optional long\n"
                        + "\t\t6: c_first_shipto_date_sk: optional long\n"
                        + "\t\t7: c_first_sales_date_sk: optional long\n"
                        + "\t\t8: c_salutation: optional string\n"
                        + "\t\t9: c_first_name: optional string\n"
                        + "\t\t10: c_last_name: optional string\n"
                        + "\t\t11: c_preferred_cust_flag: optional string\n"
                        + "\t\t12: c_birth_day: optional int\n"
                        + "\t\t13: c_birth_month: optional int\n"
                        + "\t\t14: c_birth_year: optional int\n"
                        + "\t\t15: c_birth_country: optional string\n"
                        + "\t\t16: c_login: optional string\n"
                        + "\t\t17: c_email_address: optional string\n"
                        + "\t\t18: c_last_review_date: optional long\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer_address' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer_address' schema:\n"
                        + "\tFields:\n" + "\t\t1: ca_address_sk: optional long\n"
                        + "\t\t2: ca_address_id: optional string\n"
                        + "\t\t3: ca_street_number: optional string\n"
                        + "\t\t4: ca_street_name: optional string\n"
                        + "\t\t5: ca_street_type: optional string\n"
                        + "\t\t6: ca_suite_number: optional string\n"
                        + "\t\t7: ca_city: optional string\n"
                        + "\t\t8: ca_county: optional string\n"
                        + "\t\t9: ca_state: optional string\n" + "\t\t10: ca_zip: optional string\n"
                        + "\t\t11: ca_country: optional string\n"
                        + "\t\t12: ca_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t13: ca_location_type: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer_address' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer_demographics' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer_demographics' schema:\n"
                        + "\tFields:\n" + "\t\t1: cd_demo_sk: optional long\n"
                        + "\t\t2: cd_gender: optional string\n"
                        + "\t\t3: cd_marital_status: optional string\n"
                        + "\t\t4: cd_education_status: optional string\n"
                        + "\t\t5: cd_purchase_estimate: optional int\n"
                        + "\t\t6: cd_credit_rating: optional string\n"
                        + "\t\t7: cd_dep_count: optional int\n"
                        + "\t\t8: cd_dep_employed_count: optional int\n"
                        + "\t\t9: cd_dep_college_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer_demographics' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.date_dim' successfully.\n"
                        + "Table 'test_tpcds_non_primary.date_dim' schema:\n" + "\tFields:\n"
                        + "\t\t1: d_date_sk: optional long\n"
                        + "\t\t2: d_date_id: optional string\n" + "\t\t3: d_date: optional date\n"
                        + "\t\t4: d_month_seq: optional int\n" + "\t\t5: d_week_seq: optional int\n"
                        + "\t\t6: d_quarter_seq: optional int\n" + "\t\t7: d_year: optional int\n"
                        + "\t\t8: d_dow: optional int\n" + "\t\t9: d_moy: optional int\n"
                        + "\t\t10: d_dom: optional int\n" + "\t\t11: d_qoy: optional int\n"
                        + "\t\t12: d_fy_year: optional int\n"
                        + "\t\t13: d_fy_quarter_seq: optional int\n"
                        + "\t\t14: d_fy_week_seq: optional int\n"
                        + "\t\t15: d_day_name: optional string\n"
                        + "\t\t16: d_quarter_name: optional string\n"
                        + "\t\t17: d_holiday: optional string\n"
                        + "\t\t18: d_weekend: optional string\n"
                        + "\t\t19: d_following_holiday: optional string\n"
                        + "\t\t20: d_first_dom: optional int\n"
                        + "\t\t21: d_last_dom: optional int\n"
                        + "\t\t22: d_same_day_ly: optional int\n"
                        + "\t\t23: d_same_day_lq: optional int\n"
                        + "\t\t24: d_current_day: optional string\n"
                        + "\t\t25: d_current_week: optional string\n"
                        + "\t\t26: d_current_month: optional string\n"
                        + "\t\t27: d_current_quarter: optional string\n"
                        + "\t\t28: d_current_year: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.date_dim' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.household_demographics' successfully.\n"
                        + "Table 'test_tpcds_non_primary.household_demographics' schema:\n"
                        + "\tFields:\n" + "\t\t1: hd_demo_sk: optional long\n"
                        + "\t\t2: hd_income_band_sk: optional long\n"
                        + "\t\t3: hd_buy_potential: optional string\n"
                        + "\t\t4: hd_dep_count: optional int\n"
                        + "\t\t5: hd_vehicle_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.household_demographics' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.income_band' successfully.\n"
                        + "Table 'test_tpcds_non_primary.income_band' schema:\n" + "\tFields:\n"
                        + "\t\t1: ib_income_band_sk: optional long\n"
                        + "\t\t2: ib_lower_bound: optional int\n"
                        + "\t\t3: ib_upper_bound: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.income_band' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.inventory' successfully.\n"
                        + "Table 'test_tpcds_non_primary.inventory' schema:\n" + "\tFields:\n"
                        + "\t\t1: inv_date_sk: optional long\n"
                        + "\t\t2: inv_item_sk: optional long\n"
                        + "\t\t3: inv_warehouse_sk: optional long\n"
                        + "\t\t4: inv_quantity_on_hand: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.inventory' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.item' successfully.\n"
                        + "Table 'test_tpcds_non_primary.item' schema:\n" + "\tFields:\n"
                        + "\t\t1: i_item_sk: optional long\n"
                        + "\t\t2: i_item_id: optional string\n"
                        + "\t\t3: i_rec_start_date: optional date\n"
                        + "\t\t4: i_rec_end_date: optional date\n"
                        + "\t\t5: i_item_desc: optional string\n"
                        + "\t\t6: i_current_price: optional decimal(7, 2)\n"
                        + "\t\t7: i_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t8: i_brand_id: optional int\n" + "\t\t9: i_brand: optional string\n"
                        + "\t\t10: i_class_id: optional int\n"
                        + "\t\t11: i_class: optional string\n"
                        + "\t\t12: i_category_id: optional int\n"
                        + "\t\t13: i_category: optional string\n"
                        + "\t\t14: i_manufact_id: optional int\n"
                        + "\t\t15: i_manufact: optional string\n"
                        + "\t\t16: i_size: optional string\n"
                        + "\t\t17: i_formulation: optional string\n"
                        + "\t\t18: i_color: optional string\n"
                        + "\t\t19: i_units: optional string\n"
                        + "\t\t20: i_container: optional string\n"
                        + "\t\t21: i_manager_id: optional int\n"
                        + "\t\t22: i_product_name: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.item' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.promotion' successfully.\n"
                        + "Table 'test_tpcds_non_primary.promotion' schema:\n" + "\tFields:\n"
                        + "\t\t1: p_promo_sk: optional long\n"
                        + "\t\t2: p_promo_id: optional string\n"
                        + "\t\t3: p_start_date_sk: optional long\n"
                        + "\t\t4: p_end_date_sk: optional long\n"
                        + "\t\t5: p_item_sk: optional long\n"
                        + "\t\t6: p_cost: optional decimal(15, 2)\n"
                        + "\t\t7: p_response_target: optional int\n"
                        + "\t\t8: p_promo_name: optional string\n"
                        + "\t\t9: p_channel_dmail: optional string\n"
                        + "\t\t10: p_channel_email: optional string\n"
                        + "\t\t11: p_channel_catalog: optional string\n"
                        + "\t\t12: p_channel_tv: optional string\n"
                        + "\t\t13: p_channel_radio: optional string\n"
                        + "\t\t14: p_channel_press: optional string\n"
                        + "\t\t15: p_channel_event: optional string\n"
                        + "\t\t16: p_channel_demo: optional string\n"
                        + "\t\t17: p_channel_details: optional string\n"
                        + "\t\t18: p_purpose: optional string\n"
                        + "\t\t19: p_discount_active: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.promotion' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.reason' successfully.\n"
                        + "Table 'test_tpcds_non_primary.reason' schema:\n" + "\tFields:\n"
                        + "\t\t1: r_reason_sk: optional long\n"
                        + "\t\t2: r_reason_id: optional string\n"
                        + "\t\t3: r_reason_desc: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.reason' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.ship_mode' successfully.\n"
                        + "Table 'test_tpcds_non_primary.ship_mode' schema:\n" + "\tFields:\n"
                        + "\t\t1: sm_ship_mode_sk: optional long\n"
                        + "\t\t2: sm_ship_mode_id: optional string\n"
                        + "\t\t3: sm_type: optional string\n" + "\t\t4: sm_code: optional string\n"
                        + "\t\t5: sm_carrier: optional string\n"
                        + "\t\t6: sm_contract: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.ship_mode' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store' schema:\n" + "\tFields:\n"
                        + "\t\t1: s_store_sk: optional long\n"
                        + "\t\t2: s_store_id: optional string\n"
                        + "\t\t3: s_rec_start_date: optional date\n"
                        + "\t\t4: s_rec_end_date: optional date\n"
                        + "\t\t5: s_closed_date_sk: optional long\n"
                        + "\t\t6: s_store_name: optional string\n"
                        + "\t\t7: s_number_employees: optional int\n"
                        + "\t\t8: s_floor_space: optional int\n"
                        + "\t\t9: s_hours: optional string\n"
                        + "\t\t10: s_manager: optional string\n"
                        + "\t\t11: s_market_id: optional int\n"
                        + "\t\t12: s_geography_class: optional string\n"
                        + "\t\t13: s_market_desc: optional string\n"
                        + "\t\t14: s_market_manager: optional string\n"
                        + "\t\t15: s_division_id: optional int\n"
                        + "\t\t16: s_division_name: optional string\n"
                        + "\t\t17: s_company_id: optional int\n"
                        + "\t\t18: s_company_name: optional string\n"
                        + "\t\t19: s_street_number: optional string\n"
                        + "\t\t20: s_street_name: optional string\n"
                        + "\t\t21: s_street_type: optional string\n"
                        + "\t\t22: s_suite_number: optional string\n"
                        + "\t\t23: s_city: optional string\n"
                        + "\t\t24: s_county: optional string\n"
                        + "\t\t25: s_state: optional string\n" + "\t\t26: s_zip: optional string\n"
                        + "\t\t27: s_country: optional string\n"
                        + "\t\t28: s_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t29: s_tax_precentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store' successfully, 12 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: sr_returned_date_sk: optional long\n"
                        + "\t\t2: sr_return_time_sk: optional long\n"
                        + "\t\t3: sr_item_sk: optional long\n"
                        + "\t\t4: sr_customer_sk: optional long\n"
                        + "\t\t5: sr_cdemo_sk: optional long\n"
                        + "\t\t6: sr_hdemo_sk: optional long\n"
                        + "\t\t7: sr_addr_sk: optional long\n"
                        + "\t\t8: sr_store_sk: optional long\n"
                        + "\t\t9: sr_reason_sk: optional long\n"
                        + "\t\t10: sr_ticket_number: optional long\n"
                        + "\t\t11: sr_return_quantity: optional int\n"
                        + "\t\t12: sr_return_amt: optional decimal(7, 2)\n"
                        + "\t\t13: sr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t14: sr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t15: sr_fee: optional decimal(7, 2)\n"
                        + "\t\t16: sr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t17: sr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t18: sr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t19: sr_store_credit: optional decimal(7, 2)\n"
                        + "\t\t20: sr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: ss_sold_date_sk: optional long\n"
                        + "\t\t2: ss_sold_time_sk: optional long\n"
                        + "\t\t3: ss_item_sk: optional long\n"
                        + "\t\t4: ss_customer_sk: optional long\n"
                        + "\t\t5: ss_cdemo_sk: optional long\n"
                        + "\t\t6: ss_hdemo_sk: optional long\n"
                        + "\t\t7: ss_addr_sk: optional long\n"
                        + "\t\t8: ss_store_sk: optional long\n"
                        + "\t\t9: ss_promo_sk: optional long\n"
                        + "\t\t10: ss_ticket_number: optional long\n"
                        + "\t\t11: ss_quantity: optional int\n"
                        + "\t\t12: ss_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t13: ss_list_price: optional decimal(7, 2)\n"
                        + "\t\t14: ss_sales_price: optional decimal(7, 2)\n"
                        + "\t\t15: ss_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t16: ss_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t17: ss_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t18: ss_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t19: ss_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t20: ss_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t21: ss_net_paid: optional decimal(7, 2)\n"
                        + "\t\t22: ss_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t23: ss_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.time_dim' successfully.\n"
                        + "Table 'test_tpcds_non_primary.time_dim' schema:\n" + "\tFields:\n"
                        + "\t\t1: t_time_sk: optional long\n"
                        + "\t\t2: t_time_id: optional string\n" + "\t\t3: t_time: optional int\n"
                        + "\t\t4: t_hour: optional int\n" + "\t\t5: t_minute: optional int\n"
                        + "\t\t6: t_second: optional int\n" + "\t\t7: t_am_pm: optional string\n"
                        + "\t\t8: t_shift: optional string\n"
                        + "\t\t9: t_sub_shift: optional string\n"
                        + "\t\t10: t_meal_time: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.time_dim' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.warehouse' successfully.\n"
                        + "Table 'test_tpcds_non_primary.warehouse' schema:\n" + "\tFields:\n"
                        + "\t\t1: w_warehouse_sk: optional long\n"
                        + "\t\t2: w_warehouse_id: optional string\n"
                        + "\t\t3: w_warehouse_name: optional string\n"
                        + "\t\t4: w_warehouse_sq_ft: optional int\n"
                        + "\t\t5: w_street_number: optional string\n"
                        + "\t\t6: w_street_name: optional string\n"
                        + "\t\t7: w_street_type: optional string\n"
                        + "\t\t8: w_suite_number: optional string\n"
                        + "\t\t9: w_city: optional string\n" + "\t\t10: w_county: optional string\n"
                        + "\t\t11: w_state: optional string\n" + "\t\t12: w_zip: optional string\n"
                        + "\t\t13: w_country: optional string\n"
                        + "\t\t14: w_gmt_offset: optional decimal(5, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.warehouse' successfully, 5 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_page' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_page' schema:\n" + "\tFields:\n"
                        + "\t\t1: wp_web_page_sk: optional long\n"
                        + "\t\t2: wp_web_page_id: optional string\n"
                        + "\t\t3: wp_rec_start_date: optional date\n"
                        + "\t\t4: wp_rec_end_date: optional date\n"
                        + "\t\t5: wp_creation_date_sk: optional long\n"
                        + "\t\t6: wp_access_date_sk: optional long\n"
                        + "\t\t7: wp_autogen_flag: optional string\n"
                        + "\t\t8: wp_customer_sk: optional long\n"
                        + "\t\t9: wp_url: optional string\n" + "\t\t10: wp_type: optional string\n"
                        + "\t\t11: wp_char_count: optional int\n"
                        + "\t\t12: wp_link_count: optional int\n"
                        + "\t\t13: wp_image_count: optional int\n"
                        + "\t\t14: wp_max_ad_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_page' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: wr_returned_date_sk: optional long\n"
                        + "\t\t2: wr_returned_time_sk: optional long\n"
                        + "\t\t3: wr_item_sk: optional long\n"
                        + "\t\t4: wr_refunded_customer_sk: optional long\n"
                        + "\t\t5: wr_refunded_cdemo_sk: optional long\n"
                        + "\t\t6: wr_refunded_hdemo_sk: optional long\n"
                        + "\t\t7: wr_refunded_addr_sk: optional long\n"
                        + "\t\t8: wr_returning_customer_sk: optional long\n"
                        + "\t\t9: wr_returning_cdemo_sk: optional long\n"
                        + "\t\t10: wr_returning_hdemo_sk: optional long\n"
                        + "\t\t11: wr_returning_addr_sk: optional long\n"
                        + "\t\t12: wr_web_page_sk: optional long\n"
                        + "\t\t13: wr_reason_sk: optional long\n"
                        + "\t\t14: wr_order_number: optional long\n"
                        + "\t\t15: wr_return_quantity: optional int\n"
                        + "\t\t16: wr_return_amt: optional decimal(7, 2)\n"
                        + "\t\t17: wr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t18: wr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t19: wr_fee: optional decimal(7, 2)\n"
                        + "\t\t20: wr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t21: wr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t22: wr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t23: wr_account_credit: optional decimal(7, 2)\n"
                        + "\t\t24: wr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: ws_sold_date_sk: optional long\n"
                        + "\t\t2: ws_sold_time_sk: optional long\n"
                        + "\t\t3: ws_ship_date_sk: optional long\n"
                        + "\t\t4: ws_item_sk: optional long\n"
                        + "\t\t5: ws_bill_customer_sk: optional long\n"
                        + "\t\t6: ws_bill_cdemo_sk: optional long\n"
                        + "\t\t7: ws_bill_hdemo_sk: optional long\n"
                        + "\t\t8: ws_bill_addr_sk: optional long\n"
                        + "\t\t9: ws_ship_customer_sk: optional long\n"
                        + "\t\t10: ws_ship_cdemo_sk: optional long\n"
                        + "\t\t11: ws_ship_hdemo_sk: optional long\n"
                        + "\t\t12: ws_ship_addr_sk: optional long\n"
                        + "\t\t13: ws_web_page_sk: optional long\n"
                        + "\t\t14: ws_web_site_sk: optional long\n"
                        + "\t\t15: ws_ship_mode_sk: optional long\n"
                        + "\t\t16: ws_warehouse_sk: optional long\n"
                        + "\t\t17: ws_promo_sk: optional long\n"
                        + "\t\t18: ws_order_number: optional long\n"
                        + "\t\t19: ws_quantity: optional int\n"
                        + "\t\t20: ws_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t21: ws_list_price: optional decimal(7, 2)\n"
                        + "\t\t22: ws_sales_price: optional decimal(7, 2)\n"
                        + "\t\t23: ws_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t24: ws_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t25: ws_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t26: ws_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t27: ws_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t28: ws_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t29: ws_ext_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t30: ws_net_paid: optional decimal(7, 2)\n"
                        + "\t\t31: ws_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t32: ws_net_paid_inc_ship: optional decimal(7, 2)\n"
                        + "\t\t33: ws_net_paid_inc_ship_tax: optional decimal(7, 2)\n"
                        + "\t\t34: ws_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_site' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_site' schema:\n" + "\tFields:\n"
                        + "\t\t1: web_site_sk: optional long\n"
                        + "\t\t2: web_site_id: optional string\n"
                        + "\t\t3: web_rec_start_date: optional date\n"
                        + "\t\t4: web_rec_end_date: optional date\n"
                        + "\t\t5: web_name: optional string\n"
                        + "\t\t6: web_open_date_sk: optional long\n"
                        + "\t\t7: web_close_date_sk: optional long\n"
                        + "\t\t8: web_class: optional string\n"
                        + "\t\t9: web_manager: optional string\n"
                        + "\t\t10: web_mkt_id: optional int\n"
                        + "\t\t11: web_mkt_class: optional string\n"
                        + "\t\t12: web_mkt_desc: optional string\n"
                        + "\t\t13: web_market_manager: optional string\n"
                        + "\t\t14: web_company_id: optional int\n"
                        + "\t\t15: web_company_name: optional string\n"
                        + "\t\t16: web_street_number: optional string\n"
                        + "\t\t17: web_street_name: optional string\n"
                        + "\t\t18: web_street_type: optional string\n"
                        + "\t\t19: web_suite_number: optional string\n"
                        + "\t\t20: web_city: optional string\n"
                        + "\t\t21: web_county: optional string\n"
                        + "\t\t22: web_state: optional string\n"
                        + "\t\t23: web_zip: optional string\n"
                        + "\t\t24: web_country: optional string\n"
                        + "\t\t25: web_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t26: web_tax_percentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:PARQUET\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_site' successfully, 16 rows have been inserted.\n",
                testOut.getContent());
    }

    @Test
    public void testNonPrimaryTpcdsWithFormatAvro() throws Exception {
        testNonPrimaryTpcdsWithFormat(FileFormat.AVRO);
        Assert.assertEquals(testOut.getContent(),
                "Create database 'test_tpcds_non_primary' successfully.\n"
                        + "Create table 'test_tpcds_non_primary.call_center' successfully.\n"
                        + "Table 'test_tpcds_non_primary.call_center' schema:\n" + "\tFields:\n"
                        + "\t\t1: cc_call_center_sk: optional long\n"
                        + "\t\t2: cc_call_center_id: optional string\n"
                        + "\t\t3: cc_rec_start_date: optional date\n"
                        + "\t\t4: cc_rec_end_date: optional date\n"
                        + "\t\t5: cc_closed_date_sk: optional int\n"
                        + "\t\t6: cc_open_date_sk: optional int\n"
                        + "\t\t7: cc_name: optional string\n" + "\t\t8: cc_class: optional string\n"
                        + "\t\t9: cc_employees: optional int\n" + "\t\t10: cc_sq_ft: optional int\n"
                        + "\t\t11: cc_hours: optional string\n"
                        + "\t\t12: cc_manager: optional string\n"
                        + "\t\t13: cc_mkt_id: optional int\n"
                        + "\t\t14: cc_mkt_class: optional string\n"
                        + "\t\t15: cc_mkt_desc: optional string\n"
                        + "\t\t16: cc_market_manager: optional string\n"
                        + "\t\t17: cc_division: optional int\n"
                        + "\t\t18: cc_division_name: optional string\n"
                        + "\t\t19: cc_company: optional int\n"
                        + "\t\t20: cc_company_name: optional string\n"
                        + "\t\t21: cc_street_number: optional string\n"
                        + "\t\t22: cc_street_name: optional string\n"
                        + "\t\t23: cc_street_type: optional string\n"
                        + "\t\t24: cc_suite_number: optional string\n"
                        + "\t\t25: cc_city: optional string\n"
                        + "\t\t26: cc_county: optional string\n"
                        + "\t\t27: cc_state: optional string\n"
                        + "\t\t28: cc_zip: optional string\n"
                        + "\t\t29: cc_country: optional string\n"
                        + "\t\t30: cc_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t31: cc_tax_percentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.call_center' successfully, 6 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_page' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_page' schema:\n" + "\tFields:\n"
                        + "\t\t1: cp_catalog_page_sk: optional long\n"
                        + "\t\t2: cp_catalog_page_id: optional string\n"
                        + "\t\t3: cp_start_date_sk: optional int\n"
                        + "\t\t4: cp_end_date_sk: optional int\n"
                        + "\t\t5: cp_department: optional string\n"
                        + "\t\t6: cp_catalog_number: optional int\n"
                        + "\t\t7: cp_catalog_page_number: optional int\n"
                        + "\t\t8: cp_description: optional string\n"
                        + "\t\t9: cp_type: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_page' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: cr_returned_date_sk: optional long\n"
                        + "\t\t2: cr_returned_time_sk: optional long\n"
                        + "\t\t3: cr_item_sk: optional long\n"
                        + "\t\t4: cr_refunded_customer_sk: optional long\n"
                        + "\t\t5: cr_refunded_cdemo_sk: optional long\n"
                        + "\t\t6: cr_refunded_hdemo_sk: optional long\n"
                        + "\t\t7: cr_refunded_addr_sk: optional long\n"
                        + "\t\t8: cr_returning_customer_sk: optional long\n"
                        + "\t\t9: cr_returning_cdemo_sk: optional long\n"
                        + "\t\t10: cr_returning_hdemo_sk: optional long\n"
                        + "\t\t11: cr_returning_addr_sk: optional long\n"
                        + "\t\t12: cr_call_center_sk: optional long\n"
                        + "\t\t13: cr_catalog_page_sk: optional long\n"
                        + "\t\t14: cr_ship_mode_sk: optional long\n"
                        + "\t\t15: cr_warehouse_sk: optional long\n"
                        + "\t\t16: cr_reason_sk: optional long\n"
                        + "\t\t17: cr_order_number: optional long\n"
                        + "\t\t18: cr_return_quantity: optional int\n"
                        + "\t\t19: cr_return_amount: optional decimal(7, 2)\n"
                        + "\t\t20: cr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t21: cr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t22: cr_fee: optional decimal(7, 2)\n"
                        + "\t\t23: cr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t24: cr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t25: cr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t26: cr_store_credit: optional decimal(7, 2)\n"
                        + "\t\t27: cr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.catalog_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.catalog_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: cs_sold_date_sk: optional long\n"
                        + "\t\t2: cs_sold_time_sk: optional long\n"
                        + "\t\t3: cs_ship_date_sk: optional long\n"
                        + "\t\t4: cs_bill_customer_sk: optional long\n"
                        + "\t\t5: cs_bill_cdemo_sk: optional long\n"
                        + "\t\t6: cs_bill_hdemo_sk: optional long\n"
                        + "\t\t7: cs_bill_addr_sk: optional long\n"
                        + "\t\t8: cs_ship_customer_sk: optional long\n"
                        + "\t\t9: cs_ship_cdemo_sk: optional long\n"
                        + "\t\t10: cs_ship_hdemo_sk: optional long\n"
                        + "\t\t11: cs_ship_addr_sk: optional long\n"
                        + "\t\t12: cs_call_center_sk: optional long\n"
                        + "\t\t13: cs_catalog_page_sk: optional long\n"
                        + "\t\t14: cs_ship_mode_sk: optional long\n"
                        + "\t\t15: cs_warehouse_sk: optional long\n"
                        + "\t\t16: cs_item_sk: optional long\n"
                        + "\t\t17: cs_promo_sk: optional long\n"
                        + "\t\t18: cs_order_number: optional long\n"
                        + "\t\t19: cs_quantity: optional int\n"
                        + "\t\t20: cs_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t21: cs_list_price: optional decimal(7, 2)\n"
                        + "\t\t22: cs_sales_price: optional decimal(7, 2)\n"
                        + "\t\t23: cs_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t24: cs_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t25: cs_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t26: cs_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t27: cs_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t28: cs_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t29: cs_ext_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t30: cs_net_paid: optional decimal(7, 2)\n"
                        + "\t\t31: cs_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t32: cs_net_paid_inc_ship: optional decimal(7, 2)\n"
                        + "\t\t33: cs_net_paid_inc_ship_tax: optional decimal(7, 2)\n"
                        + "\t\t34: cs_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.catalog_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer' schema:\n" + "\tFields:\n"
                        + "\t\t1: c_customer_sk: optional long\n"
                        + "\t\t2: c_customer_id: optional string\n"
                        + "\t\t3: c_current_cdemo_sk: optional long\n"
                        + "\t\t4: c_current_hdemo_sk: optional long\n"
                        + "\t\t5: c_current_addr_sk: optional long\n"
                        + "\t\t6: c_first_shipto_date_sk: optional long\n"
                        + "\t\t7: c_first_sales_date_sk: optional long\n"
                        + "\t\t8: c_salutation: optional string\n"
                        + "\t\t9: c_first_name: optional string\n"
                        + "\t\t10: c_last_name: optional string\n"
                        + "\t\t11: c_preferred_cust_flag: optional string\n"
                        + "\t\t12: c_birth_day: optional int\n"
                        + "\t\t13: c_birth_month: optional int\n"
                        + "\t\t14: c_birth_year: optional int\n"
                        + "\t\t15: c_birth_country: optional string\n"
                        + "\t\t16: c_login: optional string\n"
                        + "\t\t17: c_email_address: optional string\n"
                        + "\t\t18: c_last_review_date: optional long\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer_address' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer_address' schema:\n"
                        + "\tFields:\n" + "\t\t1: ca_address_sk: optional long\n"
                        + "\t\t2: ca_address_id: optional string\n"
                        + "\t\t3: ca_street_number: optional string\n"
                        + "\t\t4: ca_street_name: optional string\n"
                        + "\t\t5: ca_street_type: optional string\n"
                        + "\t\t6: ca_suite_number: optional string\n"
                        + "\t\t7: ca_city: optional string\n"
                        + "\t\t8: ca_county: optional string\n"
                        + "\t\t9: ca_state: optional string\n" + "\t\t10: ca_zip: optional string\n"
                        + "\t\t11: ca_country: optional string\n"
                        + "\t\t12: ca_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t13: ca_location_type: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer_address' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.customer_demographics' successfully.\n"
                        + "Table 'test_tpcds_non_primary.customer_demographics' schema:\n"
                        + "\tFields:\n" + "\t\t1: cd_demo_sk: optional long\n"
                        + "\t\t2: cd_gender: optional string\n"
                        + "\t\t3: cd_marital_status: optional string\n"
                        + "\t\t4: cd_education_status: optional string\n"
                        + "\t\t5: cd_purchase_estimate: optional int\n"
                        + "\t\t6: cd_credit_rating: optional string\n"
                        + "\t\t7: cd_dep_count: optional int\n"
                        + "\t\t8: cd_dep_employed_count: optional int\n"
                        + "\t\t9: cd_dep_college_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.customer_demographics' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.date_dim' successfully.\n"
                        + "Table 'test_tpcds_non_primary.date_dim' schema:\n" + "\tFields:\n"
                        + "\t\t1: d_date_sk: optional long\n"
                        + "\t\t2: d_date_id: optional string\n" + "\t\t3: d_date: optional date\n"
                        + "\t\t4: d_month_seq: optional int\n" + "\t\t5: d_week_seq: optional int\n"
                        + "\t\t6: d_quarter_seq: optional int\n" + "\t\t7: d_year: optional int\n"
                        + "\t\t8: d_dow: optional int\n" + "\t\t9: d_moy: optional int\n"
                        + "\t\t10: d_dom: optional int\n" + "\t\t11: d_qoy: optional int\n"
                        + "\t\t12: d_fy_year: optional int\n"
                        + "\t\t13: d_fy_quarter_seq: optional int\n"
                        + "\t\t14: d_fy_week_seq: optional int\n"
                        + "\t\t15: d_day_name: optional string\n"
                        + "\t\t16: d_quarter_name: optional string\n"
                        + "\t\t17: d_holiday: optional string\n"
                        + "\t\t18: d_weekend: optional string\n"
                        + "\t\t19: d_following_holiday: optional string\n"
                        + "\t\t20: d_first_dom: optional int\n"
                        + "\t\t21: d_last_dom: optional int\n"
                        + "\t\t22: d_same_day_ly: optional int\n"
                        + "\t\t23: d_same_day_lq: optional int\n"
                        + "\t\t24: d_current_day: optional string\n"
                        + "\t\t25: d_current_week: optional string\n"
                        + "\t\t26: d_current_month: optional string\n"
                        + "\t\t27: d_current_quarter: optional string\n"
                        + "\t\t28: d_current_year: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.date_dim' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.household_demographics' successfully.\n"
                        + "Table 'test_tpcds_non_primary.household_demographics' schema:\n"
                        + "\tFields:\n" + "\t\t1: hd_demo_sk: optional long\n"
                        + "\t\t2: hd_income_band_sk: optional long\n"
                        + "\t\t3: hd_buy_potential: optional string\n"
                        + "\t\t4: hd_dep_count: optional int\n"
                        + "\t\t5: hd_vehicle_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.household_demographics' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.income_band' successfully.\n"
                        + "Table 'test_tpcds_non_primary.income_band' schema:\n" + "\tFields:\n"
                        + "\t\t1: ib_income_band_sk: optional long\n"
                        + "\t\t2: ib_lower_bound: optional int\n"
                        + "\t\t3: ib_upper_bound: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.income_band' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.inventory' successfully.\n"
                        + "Table 'test_tpcds_non_primary.inventory' schema:\n" + "\tFields:\n"
                        + "\t\t1: inv_date_sk: optional long\n"
                        + "\t\t2: inv_item_sk: optional long\n"
                        + "\t\t3: inv_warehouse_sk: optional long\n"
                        + "\t\t4: inv_quantity_on_hand: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.inventory' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.item' successfully.\n"
                        + "Table 'test_tpcds_non_primary.item' schema:\n" + "\tFields:\n"
                        + "\t\t1: i_item_sk: optional long\n"
                        + "\t\t2: i_item_id: optional string\n"
                        + "\t\t3: i_rec_start_date: optional date\n"
                        + "\t\t4: i_rec_end_date: optional date\n"
                        + "\t\t5: i_item_desc: optional string\n"
                        + "\t\t6: i_current_price: optional decimal(7, 2)\n"
                        + "\t\t7: i_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t8: i_brand_id: optional int\n" + "\t\t9: i_brand: optional string\n"
                        + "\t\t10: i_class_id: optional int\n"
                        + "\t\t11: i_class: optional string\n"
                        + "\t\t12: i_category_id: optional int\n"
                        + "\t\t13: i_category: optional string\n"
                        + "\t\t14: i_manufact_id: optional int\n"
                        + "\t\t15: i_manufact: optional string\n"
                        + "\t\t16: i_size: optional string\n"
                        + "\t\t17: i_formulation: optional string\n"
                        + "\t\t18: i_color: optional string\n"
                        + "\t\t19: i_units: optional string\n"
                        + "\t\t20: i_container: optional string\n"
                        + "\t\t21: i_manager_id: optional int\n"
                        + "\t\t22: i_product_name: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.item' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.promotion' successfully.\n"
                        + "Table 'test_tpcds_non_primary.promotion' schema:\n" + "\tFields:\n"
                        + "\t\t1: p_promo_sk: optional long\n"
                        + "\t\t2: p_promo_id: optional string\n"
                        + "\t\t3: p_start_date_sk: optional long\n"
                        + "\t\t4: p_end_date_sk: optional long\n"
                        + "\t\t5: p_item_sk: optional long\n"
                        + "\t\t6: p_cost: optional decimal(15, 2)\n"
                        + "\t\t7: p_response_target: optional int\n"
                        + "\t\t8: p_promo_name: optional string\n"
                        + "\t\t9: p_channel_dmail: optional string\n"
                        + "\t\t10: p_channel_email: optional string\n"
                        + "\t\t11: p_channel_catalog: optional string\n"
                        + "\t\t12: p_channel_tv: optional string\n"
                        + "\t\t13: p_channel_radio: optional string\n"
                        + "\t\t14: p_channel_press: optional string\n"
                        + "\t\t15: p_channel_event: optional string\n"
                        + "\t\t16: p_channel_demo: optional string\n"
                        + "\t\t17: p_channel_details: optional string\n"
                        + "\t\t18: p_purpose: optional string\n"
                        + "\t\t19: p_discount_active: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.promotion' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.reason' successfully.\n"
                        + "Table 'test_tpcds_non_primary.reason' schema:\n" + "\tFields:\n"
                        + "\t\t1: r_reason_sk: optional long\n"
                        + "\t\t2: r_reason_id: optional string\n"
                        + "\t\t3: r_reason_desc: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.reason' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.ship_mode' successfully.\n"
                        + "Table 'test_tpcds_non_primary.ship_mode' schema:\n" + "\tFields:\n"
                        + "\t\t1: sm_ship_mode_sk: optional long\n"
                        + "\t\t2: sm_ship_mode_id: optional string\n"
                        + "\t\t3: sm_type: optional string\n" + "\t\t4: sm_code: optional string\n"
                        + "\t\t5: sm_carrier: optional string\n"
                        + "\t\t6: sm_contract: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.ship_mode' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store' schema:\n" + "\tFields:\n"
                        + "\t\t1: s_store_sk: optional long\n"
                        + "\t\t2: s_store_id: optional string\n"
                        + "\t\t3: s_rec_start_date: optional date\n"
                        + "\t\t4: s_rec_end_date: optional date\n"
                        + "\t\t5: s_closed_date_sk: optional long\n"
                        + "\t\t6: s_store_name: optional string\n"
                        + "\t\t7: s_number_employees: optional int\n"
                        + "\t\t8: s_floor_space: optional int\n"
                        + "\t\t9: s_hours: optional string\n"
                        + "\t\t10: s_manager: optional string\n"
                        + "\t\t11: s_market_id: optional int\n"
                        + "\t\t12: s_geography_class: optional string\n"
                        + "\t\t13: s_market_desc: optional string\n"
                        + "\t\t14: s_market_manager: optional string\n"
                        + "\t\t15: s_division_id: optional int\n"
                        + "\t\t16: s_division_name: optional string\n"
                        + "\t\t17: s_company_id: optional int\n"
                        + "\t\t18: s_company_name: optional string\n"
                        + "\t\t19: s_street_number: optional string\n"
                        + "\t\t20: s_street_name: optional string\n"
                        + "\t\t21: s_street_type: optional string\n"
                        + "\t\t22: s_suite_number: optional string\n"
                        + "\t\t23: s_city: optional string\n"
                        + "\t\t24: s_county: optional string\n"
                        + "\t\t25: s_state: optional string\n" + "\t\t26: s_zip: optional string\n"
                        + "\t\t27: s_country: optional string\n"
                        + "\t\t28: s_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t29: s_tax_precentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store' successfully, 12 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: sr_returned_date_sk: optional long\n"
                        + "\t\t2: sr_return_time_sk: optional long\n"
                        + "\t\t3: sr_item_sk: optional long\n"
                        + "\t\t4: sr_customer_sk: optional long\n"
                        + "\t\t5: sr_cdemo_sk: optional long\n"
                        + "\t\t6: sr_hdemo_sk: optional long\n"
                        + "\t\t7: sr_addr_sk: optional long\n"
                        + "\t\t8: sr_store_sk: optional long\n"
                        + "\t\t9: sr_reason_sk: optional long\n"
                        + "\t\t10: sr_ticket_number: optional long\n"
                        + "\t\t11: sr_return_quantity: optional int\n"
                        + "\t\t12: sr_return_amt: optional decimal(7, 2)\n"
                        + "\t\t13: sr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t14: sr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t15: sr_fee: optional decimal(7, 2)\n"
                        + "\t\t16: sr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t17: sr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t18: sr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t19: sr_store_credit: optional decimal(7, 2)\n"
                        + "\t\t20: sr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.store_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.store_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: ss_sold_date_sk: optional long\n"
                        + "\t\t2: ss_sold_time_sk: optional long\n"
                        + "\t\t3: ss_item_sk: optional long\n"
                        + "\t\t4: ss_customer_sk: optional long\n"
                        + "\t\t5: ss_cdemo_sk: optional long\n"
                        + "\t\t6: ss_hdemo_sk: optional long\n"
                        + "\t\t7: ss_addr_sk: optional long\n"
                        + "\t\t8: ss_store_sk: optional long\n"
                        + "\t\t9: ss_promo_sk: optional long\n"
                        + "\t\t10: ss_ticket_number: optional long\n"
                        + "\t\t11: ss_quantity: optional int\n"
                        + "\t\t12: ss_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t13: ss_list_price: optional decimal(7, 2)\n"
                        + "\t\t14: ss_sales_price: optional decimal(7, 2)\n"
                        + "\t\t15: ss_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t16: ss_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t17: ss_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t18: ss_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t19: ss_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t20: ss_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t21: ss_net_paid: optional decimal(7, 2)\n"
                        + "\t\t22: ss_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t23: ss_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.store_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.time_dim' successfully.\n"
                        + "Table 'test_tpcds_non_primary.time_dim' schema:\n" + "\tFields:\n"
                        + "\t\t1: t_time_sk: optional long\n"
                        + "\t\t2: t_time_id: optional string\n" + "\t\t3: t_time: optional int\n"
                        + "\t\t4: t_hour: optional int\n" + "\t\t5: t_minute: optional int\n"
                        + "\t\t6: t_second: optional int\n" + "\t\t7: t_am_pm: optional string\n"
                        + "\t\t8: t_shift: optional string\n"
                        + "\t\t9: t_sub_shift: optional string\n"
                        + "\t\t10: t_meal_time: optional string\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.time_dim' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.warehouse' successfully.\n"
                        + "Table 'test_tpcds_non_primary.warehouse' schema:\n" + "\tFields:\n"
                        + "\t\t1: w_warehouse_sk: optional long\n"
                        + "\t\t2: w_warehouse_id: optional string\n"
                        + "\t\t3: w_warehouse_name: optional string\n"
                        + "\t\t4: w_warehouse_sq_ft: optional int\n"
                        + "\t\t5: w_street_number: optional string\n"
                        + "\t\t6: w_street_name: optional string\n"
                        + "\t\t7: w_street_type: optional string\n"
                        + "\t\t8: w_suite_number: optional string\n"
                        + "\t\t9: w_city: optional string\n" + "\t\t10: w_county: optional string\n"
                        + "\t\t11: w_state: optional string\n" + "\t\t12: w_zip: optional string\n"
                        + "\t\t13: w_country: optional string\n"
                        + "\t\t14: w_gmt_offset: optional decimal(5, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.warehouse' successfully, 5 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_page' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_page' schema:\n" + "\tFields:\n"
                        + "\t\t1: wp_web_page_sk: optional long\n"
                        + "\t\t2: wp_web_page_id: optional string\n"
                        + "\t\t3: wp_rec_start_date: optional date\n"
                        + "\t\t4: wp_rec_end_date: optional date\n"
                        + "\t\t5: wp_creation_date_sk: optional long\n"
                        + "\t\t6: wp_access_date_sk: optional long\n"
                        + "\t\t7: wp_autogen_flag: optional string\n"
                        + "\t\t8: wp_customer_sk: optional long\n"
                        + "\t\t9: wp_url: optional string\n" + "\t\t10: wp_type: optional string\n"
                        + "\t\t11: wp_char_count: optional int\n"
                        + "\t\t12: wp_link_count: optional int\n"
                        + "\t\t13: wp_image_count: optional int\n"
                        + "\t\t14: wp_max_ad_count: optional int\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_page' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_returns' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_returns' schema:\n" + "\tFields:\n"
                        + "\t\t1: wr_returned_date_sk: optional long\n"
                        + "\t\t2: wr_returned_time_sk: optional long\n"
                        + "\t\t3: wr_item_sk: optional long\n"
                        + "\t\t4: wr_refunded_customer_sk: optional long\n"
                        + "\t\t5: wr_refunded_cdemo_sk: optional long\n"
                        + "\t\t6: wr_refunded_hdemo_sk: optional long\n"
                        + "\t\t7: wr_refunded_addr_sk: optional long\n"
                        + "\t\t8: wr_returning_customer_sk: optional long\n"
                        + "\t\t9: wr_returning_cdemo_sk: optional long\n"
                        + "\t\t10: wr_returning_hdemo_sk: optional long\n"
                        + "\t\t11: wr_returning_addr_sk: optional long\n"
                        + "\t\t12: wr_web_page_sk: optional long\n"
                        + "\t\t13: wr_reason_sk: optional long\n"
                        + "\t\t14: wr_order_number: optional long\n"
                        + "\t\t15: wr_return_quantity: optional int\n"
                        + "\t\t16: wr_return_amt: optional decimal(7, 2)\n"
                        + "\t\t17: wr_return_tax: optional decimal(7, 2)\n"
                        + "\t\t18: wr_return_amt_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t19: wr_fee: optional decimal(7, 2)\n"
                        + "\t\t20: wr_return_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t21: wr_refunded_cash: optional decimal(7, 2)\n"
                        + "\t\t22: wr_reversed_charge: optional decimal(7, 2)\n"
                        + "\t\t23: wr_account_credit: optional decimal(7, 2)\n"
                        + "\t\t24: wr_net_loss: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_returns' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_sales' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_sales' schema:\n" + "\tFields:\n"
                        + "\t\t1: ws_sold_date_sk: optional long\n"
                        + "\t\t2: ws_sold_time_sk: optional long\n"
                        + "\t\t3: ws_ship_date_sk: optional long\n"
                        + "\t\t4: ws_item_sk: optional long\n"
                        + "\t\t5: ws_bill_customer_sk: optional long\n"
                        + "\t\t6: ws_bill_cdemo_sk: optional long\n"
                        + "\t\t7: ws_bill_hdemo_sk: optional long\n"
                        + "\t\t8: ws_bill_addr_sk: optional long\n"
                        + "\t\t9: ws_ship_customer_sk: optional long\n"
                        + "\t\t10: ws_ship_cdemo_sk: optional long\n"
                        + "\t\t11: ws_ship_hdemo_sk: optional long\n"
                        + "\t\t12: ws_ship_addr_sk: optional long\n"
                        + "\t\t13: ws_web_page_sk: optional long\n"
                        + "\t\t14: ws_web_site_sk: optional long\n"
                        + "\t\t15: ws_ship_mode_sk: optional long\n"
                        + "\t\t16: ws_warehouse_sk: optional long\n"
                        + "\t\t17: ws_promo_sk: optional long\n"
                        + "\t\t18: ws_order_number: optional long\n"
                        + "\t\t19: ws_quantity: optional int\n"
                        + "\t\t20: ws_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t21: ws_list_price: optional decimal(7, 2)\n"
                        + "\t\t22: ws_sales_price: optional decimal(7, 2)\n"
                        + "\t\t23: ws_ext_discount_amt: optional decimal(7, 2)\n"
                        + "\t\t24: ws_ext_sales_price: optional decimal(7, 2)\n"
                        + "\t\t25: ws_ext_wholesale_cost: optional decimal(7, 2)\n"
                        + "\t\t26: ws_ext_list_price: optional decimal(7, 2)\n"
                        + "\t\t27: ws_ext_tax: optional decimal(7, 2)\n"
                        + "\t\t28: ws_coupon_amt: optional decimal(7, 2)\n"
                        + "\t\t29: ws_ext_ship_cost: optional decimal(7, 2)\n"
                        + "\t\t30: ws_net_paid: optional decimal(7, 2)\n"
                        + "\t\t31: ws_net_paid_inc_tax: optional decimal(7, 2)\n"
                        + "\t\t32: ws_net_paid_inc_ship: optional decimal(7, 2)\n"
                        + "\t\t33: ws_net_paid_inc_ship_tax: optional decimal(7, 2)\n"
                        + "\t\t34: ws_net_profit: optional decimal(7, 2)\n" + "\tPartitionFields:\n"
                        + "\tSchemaProperties:\n" + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_sales' successfully, 16 rows have been inserted.\n"
                        + "Create table 'test_tpcds_non_primary.web_site' successfully.\n"
                        + "Table 'test_tpcds_non_primary.web_site' schema:\n" + "\tFields:\n"
                        + "\t\t1: web_site_sk: optional long\n"
                        + "\t\t2: web_site_id: optional string\n"
                        + "\t\t3: web_rec_start_date: optional date\n"
                        + "\t\t4: web_rec_end_date: optional date\n"
                        + "\t\t5: web_name: optional string\n"
                        + "\t\t6: web_open_date_sk: optional long\n"
                        + "\t\t7: web_close_date_sk: optional long\n"
                        + "\t\t8: web_class: optional string\n"
                        + "\t\t9: web_manager: optional string\n"
                        + "\t\t10: web_mkt_id: optional int\n"
                        + "\t\t11: web_mkt_class: optional string\n"
                        + "\t\t12: web_mkt_desc: optional string\n"
                        + "\t\t13: web_market_manager: optional string\n"
                        + "\t\t14: web_company_id: optional int\n"
                        + "\t\t15: web_company_name: optional string\n"
                        + "\t\t16: web_street_number: optional string\n"
                        + "\t\t17: web_street_name: optional string\n"
                        + "\t\t18: web_street_type: optional string\n"
                        + "\t\t19: web_suite_number: optional string\n"
                        + "\t\t20: web_city: optional string\n"
                        + "\t\t21: web_county: optional string\n"
                        + "\t\t22: web_state: optional string\n"
                        + "\t\t23: web_zip: optional string\n"
                        + "\t\t24: web_country: optional string\n"
                        + "\t\t25: web_gmt_offset: optional decimal(5, 2)\n"
                        + "\t\t26: web_tax_percentage: optional decimal(5, 2)\n"
                        + "\tPartitionFields:\n" + "\tSchemaProperties:\n"
                        + "\t\twrite.format.default:AVRO\n"
                        + "\t\twrite.parquet.compression-codec:zstd\n"
                        + "Load table 'test_tpcds_non_primary.web_site' successfully, 16 rows have been inserted.\n",
                testOut.getContent());
    }

    private void testNonPrimaryTpcdsWithFormat(FileFormat format) throws Exception {
        List<String> tables = Lists.newArrayList("call_center", "catalog_page", "catalog_returns",
                "catalog_sales", "customer", "customer_address", "customer_demographics",
                "date_dim", "household_demographics", "income_band", "inventory", "item",
                "promotion", "reason", "ship_mode", "store", "store_returns", "store_sales",
                "time_dim", "warehouse", "web_page", "web_returns", "web_sales", "web_site");
        String database = "test_tpcds_non_primary";
        createDatabase(database);
        for (String table : tables) {
            createTableWithFormat(database, table, format,
                    String.format("/tpcds/%s_template.json", table));
            showTableSchema(database, table);
            loadTable(database, table, String.format("/tpcds/%s.csv", table), 4096, ',');
        }
    }
}
